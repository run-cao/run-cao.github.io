(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{498:function(s,t,a){"use strict";a.r(t);var e=a(62),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker-redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-redis"}},[s._v("#")]),s._v(" Docker Redis")]),s._v(" "),a("p",[s._v("docker hub 网址："),a("a",{attrs:{href:"https://hub.docker.com/_/redis",target:"_blank",rel:"noopener noreferrer"}},[a("em",[s._v("https://hub.docker.com/_/redis")]),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("当前"),a("small",[s._v("（2020-04-02）")]),s._v(" "),a("strong",[s._v("latest")]),s._v(" 版本和 "),a("strong",[s._v("6.2.1")]),s._v(" 是同一个版本。")]),s._v(" "),a("h2",{attrs:{id:"_1-安装及测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装及测试"}},[s._v("#")]),s._v(" 1. 安装及测试")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询中央仓库")]),s._v("\ndocker search -f is-official"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true redis\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从中央仓库下载")]),s._v("\ndocker pull redis:6.2.1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或，直接导入已有的镜像文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i redis-6.2.1.tar")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看本地镜像")]),s._v("\ndocker images\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 会出现类似以下内容：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# REPOSITORY  TAG      IMAGE ID        CREATED        SIZE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis       6.2.1    7f33e76fcb56    45 hours ago   105MB")]),s._v("\n")])])]),a("p",[s._v("运行容器：")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除曾经已有的同名容器")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f redis-test\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建并运行 redis 容器的语法")]),s._v("\ndocker run -d --name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("指定容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -p "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("指定宿主机端口"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":6379 redis:6.2.1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 docker ps 命令查看容器的运行信息")]),s._v("\n")])])]),a("p",[s._v("例如：")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("docker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   -d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   --name redis-test "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   redis:6.2.1\n")])])]),a("p",[s._v("验证安装成功")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入 redis-test 容器")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it redis-test /bin/bash\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行 redis-cli 连接 redis server")]),s._v("\nredis-cli\n")])])]),a("h2",{attrs:{id:"_2-容器中的配置文件和数据的存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-容器中的配置文件和数据的存储"}},[s._v("#")]),s._v(" 2. 容器中的配置文件和数据的存储")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("docker-redis 的 “数据存储目录” 在容器内部的")]),s._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/data\n")])])]),a("p",[s._v("很显然，只有开启持久化功能时，才会有数据存储于此。")])]),s._v(" "),a("li",[a("p",[s._v("早期的 Docker Redis 在容器中有默认的配置文件，但现在没有了。")]),s._v(" "),a("p",[s._v("从 5.x 版本开始 Docker Redis 改变了思路，容器内部不在包含配置文件，而是 "),a("strong",[s._v("要求容器启动时指定宿主机中的一个文件作为配置文件")]),s._v(" 。")]),s._v(" "),a("p",[s._v("例如：")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("docker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("宿主机上的redis.conf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":/usr/local/etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  redis:6.2.1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  redis-server /usr/local/etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),a("p",[s._v("当然，如果你没有提供配置文件，它还是有默认的配置的，只不过你在容器中找不到配置文件。")])])]),s._v(" "),a("h2",{attrs:{id:"_3-配置与挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置与挂载"}},[s._v("#")]),s._v(" 3. 配置与挂载")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("删除已存在的同名容器")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f redis-6379\n")])])])]),s._v(" "),a("li",[a("p",[s._v("创建本机挂载目录")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p ~/docker/redis/6379/data\n")])])])]),s._v(" "),a("li",[a("p",[s._v("创建并运行容器")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("docker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   -d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   --name redis-6379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   -v ~/docker/redis/6379/redis.conf:/usr/local/etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   -v ~/docker/redis/6379/data:/data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   redis:6.2.1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   redis-server /usr/local/etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   --appendonly "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" \n")])])]),a("p",[a("strong",[s._v("--appendonly yes")]),s._v(" 开启 Redis 持久化功能。")])])]),s._v(" "),a("h2",{attrs:{id:"_4-docker-compose-启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-docker-compose-启动"}},[s._v("#")]),s._v(" 4. docker-compose 启动")]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mem_limit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 512m\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 6379"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"~/docker/6379/data:/data"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./docker/6379/redis.conf:/usr/local/etc/redis/redis.conf"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server /usr/local/etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("appendonly yes\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);