(window.webpackJsonp=window.webpackJsonp||[]).push([[308],{780:function(t,s,a){"use strict";a.r(s);var _=a(62),e=Object(_.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"mysql-中文乱码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql-中文乱码"}},[t._v("#")]),t._v(" MySQL 中文乱码")]),t._v(" "),a("p",[t._v("为了能在数据库中存储中文数据并确保不会出现中文乱码错误，通常我们需要将字符集设置为 utf8 ，或其它支持中文的字符集。")]),t._v(" "),a("p",[t._v("MySQL 的默认字符集 "),a("strong",[t._v("latin1")]),t._v(" 是不支持中文的。")]),t._v(" "),a("h2",{attrs:{id:"_1-查看字符编码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看字符编码"}},[t._v("#")]),t._v(" 1. 查看字符编码")]),t._v(" "),a("p",[t._v("通过 MySQL 客户端连接到 MySQL 服务器后，执行如下命令：")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("show")]),t._v(" variables "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%char%'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("在显示的表格状的结果中，表现出有三项配置的值是 "),a("code",[t._v("latin1")]),a("small",[t._v("（或其它）")]),t._v(" 。它们分别是：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("#")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("配置项")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("character_set_client")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("character_set_connection")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("character_set_results")])])])]),t._v(" "),a("p",[t._v("我们最终的目的是需要将它们三项和其它的配置一样，改为 "),a("strong",[t._v("utf8")]),t._v(" 。")]),t._v(" "),a("blockquote",[a("p",[t._v("注意，上述表格装的结果中，『"),a("strong",[t._v("并不是")]),t._v("』说所有项目都必须为 "),a("strong",[t._v("utf8")]),t._v(" 。其中，"),a("strong",[t._v("character_set_filesystem")]),t._v(" 的值为 "),a("strong",[t._v("binary")]),t._v("、"),a("strong",[t._v("character_sets_dir")]),t._v(" 的值是一个路径。这两项本应如此，不需要动它们。")])]),t._v(" "),a("h2",{attrs:{id:"_2-修改方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改方案"}},[t._v("#")]),t._v(" 2. 修改方案")]),t._v(" "),a("h3",{attrs:{id:"_2-1-方案一-my-ini-配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-方案一-my-ini-配置文件"}},[t._v("#")]),t._v(" 2.1 方案一：my.ini 配置文件")]),t._v(" "),a("p",[a("strong",[t._v("my.ini")]),t._v(" 文件是 MySQL 的配置文件。MySQL 服务器启动时会从中读取相关配置。如果这个配置文件不存在，或者配置文件中未明确标识的配置项，MySQL 就是用默认配置。很显然 "),a("strong",[t._v("latin1")]),t._v(" 就是上述三个配置项的默认值。")]),t._v(" "),a("p",[a("small",[t._v("无论是在安装版还是在解压版的 MySQL 中，"),a("strong",[t._v("my.ini")]),t._v(" 文件都是在 MySQL 的家目录下。")])]),t._v(" "),a("p",[t._v("打开并编辑 "),a("strong",[t._v("my.ini")]),t._v(" 配置文件：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("在 "),a("strong",[t._v("[mysql]")]),t._v(" 配置段下添加 "),a("strong",[t._v("default-character-set=utf8")]),t._v(" 。")])]),t._v(" "),a("li",[a("p",[t._v("在 "),a("strong",[t._v("[mysqld]")]),t._v(" 配置段下添加 "),a("strong",[t._v("character_set_server=utf8")]),t._v(" 。")])])]),t._v(" "),a("p",[t._v("需要注意的有两点：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("只需要添加这两个配置，就能影响之前所说的三项配置。")])]),t._v(" "),a("li",[a("p",[t._v("在早期的 MySQL 版本中，"),a("strong",[t._v("[mysqld]")]),t._v(" 配置段下添加的本来和 "),a("strong",[t._v("[mysql]")]),t._v(" 一样，也是 "),a("em",[t._v("defalt-character-set=utf8")]),t._v(" 。不过，后来的 MySQL 版本中将的这个配置的名字改了。")])])]),t._v(" "),a("p",[t._v("为 "),a("code",[t._v("my.ini")]),t._v(" 添加了这两项配置后，重启 MySQL 服务，再在 MySQL 客户端中执行 "),a("code",[t._v("show variables like '%char%';")]),t._v(" 命令，你会发现之前所说的三项值从 "),a("code",[t._v("latin1")]),t._v(" 变为了 "),a("code",[t._v("utf8")]),t._v(" 。")]),t._v(" "),a("p",[t._v("这个方案有一个问题，你可能没有权限修改 "),a("em",[a("strong",[t._v("my.ini")])]),t._v(" 文件，或无法取修改 "),a("em",[a("strong",[t._v("my.ini")])]),t._v(" 文件！")]),t._v(" "),a("p",[t._v("这种情况下，你即便知道要将 my.ini 中修改成 xxx 样子，就能修改字符集编码，但是你也无能为力。这种情况下，你需要使用下面这种方案。")]),t._v(" "),a("h3",{attrs:{id:"_2-2-方案二-在建库时指定表的字符集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-方案二-在建库时指定表的字符集"}},[t._v("#")]),t._v(" 2.2 方案二：在建库时指定表的字符集")]),t._v(" "),a("p",[t._v("my.ini 中的这些配置都是默认配置，在创建数据库（ "),a("code",[t._v("create database")]),t._v(" ）时，如果你指定了 database 的字符集，那么 MySQL 就以你的建库语句中所指定的字符集为准，而非 my.ini 的默认配置。")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DATABASE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("库名"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 设置字符集")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("其它设置\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("一个良好的习惯是，不要依赖于 my.ini 的设置，在你提供的建库语句中老老实实加上字符集设置！")])]),t._v(" "),a("p",[a("strong",[t._v("一个良好的习惯是，不要依赖于 my.ini 的设置，在你提供的建库语句中老老实实加上字符集设置！")])]),t._v(" "),a("p",[a("strong",[t._v("一个良好的习惯是，不要依赖于 my.ini 的设置，在你提供的建库语句中老老实实加上字符集设置！")])]),t._v(" "),a("h3",{attrs:{id:"_2-3-方案三-通过-sql-命令修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-方案三-通过-sql-命令修改"}},[t._v("#")]),t._v(" 2.3 方案三：通过 SQL 命令修改")]),t._v(" "),a("p",[t._v("这是你在『最倒霉』的情况下要使用的方案，你『倒霉』在 2 点：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("你没有权限，或无法修改 my.ini 配置文件的内容。"),a("small",[t._v("即，方案一不可行")]),t._v("；")])]),t._v(" "),a("li",[a("p",[t._v("databse 不是你建的，而且已经建好了，“当年”建库时没有指定 utf8 字符集，现在，你又不能删库重建。"),a("small",[t._v("即，方案二不可能。")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("当然，一般情况下你不可能这么倒霉，或者说，真遇到了这种情况，那就意味着之前的某些工作出了问题，可以调整、修正，而不是靠你在这里曲线救国。")])]),t._v(" "),a("p",[t._v("在 SQL 命令行中依次输入三条"),a("small",[t._v("（与上述三个配置对应的）")]),t._v("命令：")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" character_set_client"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" character_set_connection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" character_set_results"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("再次执行 "),a("code",[t._v("show variables like '%char%';")]),t._v(" 命令，你会发现这三个配置已经变为了 "),a("code",[t._v("utf8")]),t._v("。")]),t._v(" "),a("p",[t._v("但是，当你退出 MySQL 客户端再重新连接到 MySQL 服务器时，你会发现这三项配置又变回来了！这是因为通过 SQL 命令的修改只对本次连接/会话有效。因此这种方法基本上没用。")]),t._v(" "),a("p",[t._v("这种情况下，你本次连接中向 MySQL 的表中加入、修改的字符数据会被 MySQL 以 utf8 方式存储，而无视 my.ini 和建库语句中的字符集设置。")])])}),[],!1,null,null,null);s.default=e.exports}}]);