(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{501:function(t,s,a){"use strict";a.r(s);var n=a(62),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"docker-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-nginx"}},[t._v("#")]),t._v(" Docker Nginx")]),t._v(" "),a("p",[t._v("docker hub 网址："),a("a",{attrs:{href:"https://hub.docker.com/_/nginx",target:"_blank",rel:"noopener noreferrer"}},[a("em",[t._v("https://hub.docker.com/_/nginx")]),a("OutboundLink")],1),t._v(" 。")]),t._v(" "),a("p",[t._v("当前"),a("small",[t._v("（2021-12-17）")]),t._v(" "),a("strong",[t._v("latest")]),t._v(" 版本和 "),a("strong",[t._v("1.21.4")]),t._v(" 版本是同一个版本；"),a("strong",[t._v("stable")]),t._v(" 版本和 "),a("strong",[t._v("1.20.2")]),t._v(" 版本是同一个版本。")]),t._v(" "),a("h2",{attrs:{id:"_1-安装及测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装及测试"}},[t._v("#")]),t._v(" 1. 安装及测试")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询中央仓库")]),t._v("\ndocker search -f is-official"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true mysql\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从中央仓库下载")]),t._v("\ndocker pull nginx:1.20.2\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或，直接导入已有的镜像文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker load -i nginx-1.20.2.tar")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看本地镜像")]),t._v("\ndocker images\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 会出现类似如下内容：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# REPOSITORY    TAG       IMAGE ID       CREATED        SIZE")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nginx         1.18.0    b9e1dc12387a   2 months ago   133MB")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nginx         1.19.9    7ce4f91ef623   2 days ago     133MB")]),t._v("\n\n")])])]),a("p",[t._v("运行容器：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除曾经已有的同名容器")]),t._v("\ndocker stop nginx-test\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" nginx-test\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建并运行 nginx 容器的语法")]),t._v("\ndocker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("指定容器名"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("指定宿主机端口"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":80 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" \n    nginx:1.20.2\n")])])]),a("p",[t._v("例如：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("docker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --name nginx-test "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(":80 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" \n    nginx:1.20.2\n")])])]),a("p",[t._v("验证安装成功")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("通过 "),a("strong",[t._v("docker ps")]),t._v(" 命令查看容器的运行信息：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("docker "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v("\n")])])]),a("p",[t._v("会看到类似如下信息:")]),t._v(" "),a("p",[t._v("略")])]),t._v(" "),a("li",[a("p",[t._v("访问 nginx 主页")]),t._v(" "),a("p",[t._v("启动容器后，访问 "),a("strong",[t._v("http://宿主机IP:80")]),t._v(" 能看到 Nginx 的欢迎界面： "),a("strong",[t._v("Welcome to nginx!")])])])]),t._v(" "),a("h2",{attrs:{id:"_2-容器中的配置文件和数据的存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-容器中的配置文件和数据的存储"}},[t._v("#")]),t._v(" 2. 容器中的配置文件和数据的存储")]),t._v(" "),a("ul",[a("li",[t._v("Docker Nginx 的 “日志” 目录是容器中的")])]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/var/log/nginx/\n")])])]),a("ul",[a("li",[t._v("docker-nginx 的静态资源文件目录是容器中的")])]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/usr/share/nginx/html\n")])])]),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("警告")]),t._v(" "),a("p",[t._v("有同学发现以前的版本中 docker-nginx 并不是到容器中的 "),a("code",[t._v("/usr/share/nginx/html")]),t._v(" 目录下加载 .html 等静态资源，而是到的 "),a("code",[t._v("/etc/nginx/html")]),t._v(" 下找。")]),t._v(" "),a("p",[t._v("虽然 nginx:1.20.0 是如官方所说使用的是容器中的 "),a("code",[t._v("/usr/share/nginx/html")]),t._v(" 目录"),a("small",[t._v("（1.18.x 好像也是，1.16.x 就不记得了）")]),t._v("。然是，如果大家使用 docker-nginx 时，特别是使用老版本时，一旦发现启动 docker-nginx 之后找不到 .html ，那么就留意一下 error.log ，看看错误信息中显示的是到哪里『找』文件，然后调整一下你的映射路径。")])]),t._v(" "),a("ul",[a("li",[t._v("docker-nginx 的配置文件是容器中的")])]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/etc/nginx/nginx.conf\n")])])]),a("h2",{attrs:{id:"_3-配置与挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置与挂载"}},[t._v("#")]),t._v(" 3. 配置与挂载")]),t._v(" "),a("ul",[a("li",[t._v("删除已存在的同名容器")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("docker "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -f nginx-80\n")])])]),a("ul",[a("li",[t._v("在宿主机上创建目录及配置文件")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p ~/docker/80/log\n")])])]),a("ul",[a("li",[t._v("创建并运行容器")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("docker run  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -d  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --name nginx-80 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(":80 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -v ~/docker/80/log:/var/log/nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    nginx:1.20.2\n")])])]),a("h2",{attrs:{id:"_4-docker-compose-启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-docker-compose-启动"}},[t._v("#")]),t._v(" 4. docker-compose 启动")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nginx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("1.20.2\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zgg\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ~/docker/80/logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/nginx/logs\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ~/docker/80/html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/usr/share/nginx/html\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token datetime number"}},[t._v("80:80")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);