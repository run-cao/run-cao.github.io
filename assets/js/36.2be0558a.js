(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{508:function(t,a,s){"use strict";s.r(a);var e=s(62),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"docker-安装-seata-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装-seata-server"}},[t._v("#")]),t._v(" Docker 安装 Seata Server")]),t._v(" "),s("h2",{attrs:{id:"_1-前期准备工作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-前期准备工作"}},[t._v("#")]),t._v(" 1. 前期准备工作")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("下载 seata-server 镜像")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("docekr pull seataio/seata-server:1.4.2\n")])])])]),t._v(" "),s("li",[s("p",[t._v("启动数据库，创建相关表")]),t._v(" "),s("p",[t._v("Seata Server 在工作期间有一些数据需要存储，Seata 支持多种存储方式。这里，我们使用的是数据库作为存储方式，因此需要先启动数据库，并创建对应的 database 和 tables 。")]),t._v(" "),s("p",[t._v("初始化数据库的 sql 脚本见《模板》。另外，因为我们使用的是 MySQL 8，因此准备好 mysql 的驱动包，")]),t._v(" "),s("p",[t._v("略")])]),t._v(" "),s("li",[s("p",[t._v("启动 Nacos")]),t._v(" "),s("p",[t._v("Seata Server 在工作期间需要有注册中心和配置中心，Seata Server 支持多种注册中心和配置中心。这里，我们使用的是 Nacos，因此需要先启动 Nacos 。")]),t._v(" "),s("p",[t._v("略。")])]),t._v(" "),s("li",[s("p",[t._v("上传 Seata 配置项到 Nacos")]),t._v(" "),s("p",[t._v("我们使用了 Nacos 作为 Seata Server 的配置中心，自然就要上传 Seata Server 的配置项到 Nacos 。")]),t._v(" "),s("p",[t._v("为了简化繁琐的逐条输入，Seata 官方提供了一个 "),s("code",[t._v("seata-config.sh")]),t._v(" 的脚本来帮助我们实现批量上传，我们只需要将 Seata Server 的配置项写在一个名为 "),s("code",[t._v("config.txt")]),t._v(" 的配置文件中，然后执行 seata-config.sh 即可。需要注意的是，"),s("strong",[t._v("默认情况下，config.txt 要在 seata-config.sh 的上一级目录")]),t._v(" 。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" nacos-config.sh -h "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.172")]),t._v(".0.24 -u nacos -w nacos\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"_2-docker-compose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-docker-compose"}},[t._v("#")]),t._v(" 2. docker-compose")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("seata-server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" seataio/seata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("1.4.2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" seata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("network_mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mem_limit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 512m\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" SEATA_IP=192.172.0.24\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" SEATA_PORT=8091\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" STORE_MODE=file\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /etc/localtime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/localtime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ro\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ~/docker/8091/logs/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/root/logs/seata\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./config/seata/registry.conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/seata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server/resources/registry.conf\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./config/seata/mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("connector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("java"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8.0.21.jar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/seata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server/libs/mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("connector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("java"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8.0.21.jar\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#       ports:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           - "8091:8091"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("depends_on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" mysql\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);