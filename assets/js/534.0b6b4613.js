(window.webpackJsonp=window.webpackJsonp||[]).push([[534],{1006:function(t,e,a){"use strict";a.r(e);var v=a(62),_=Object(v.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"生命周期钩子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生命周期钩子"}},[t._v("#")]),t._v(" 生命周期钩子")]),t._v(" "),a("p",[t._v("『"),a("strong",[t._v("生命周期")]),t._v("』指的是从组件被创建并添加到 DOM，到组件被销毁的整个过程。")]),t._v(" "),a("p",[t._v("Vue 的生命周期有 4 个阶段，每个阶段都有 2 个『"),a("strong",[t._v("钩子函数")]),t._v("』，这一共就是 8 个。这 8 个函数也被称为生命周期钩子，它们在 4 个阶段中会被依次调用，有的甚至会被反复调用。")]),t._v(" "),a("p",[t._v("8 个生命周期钩子，其中 4 个是带有 "),a("strong",[t._v("before")]),t._v(" 前缀的钩子，它们会先于其它钩子被调用。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("#")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("钩子")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("beforeCreate")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("created")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("beforeMount")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("mounted")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("beforeUpdate")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("6")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("updated")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("7")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("beforeDestroy")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("8")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("destroyed")])])])]),t._v(" "),a("p",[t._v("尽管看起来确实很多钩子，但你只需要记住 4 个"),a("small",[t._v("（created、mounted、updated 和 destroyed）")]),t._v("，然后可以推导出其它 4 个。")]),t._v(" "),a("blockquote",[a("p",[t._v("Vue 从页面初始化到页面完全渲染经历了什么？")])]),t._v(" "),a("h2",{attrs:{id:"_1-new-view"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-new-view"}},[t._v("#")]),t._v(" 1. new View()")]),t._v(" "),a("p",[t._v("在 beforeCreate 之前就干了一件事情，就是 new Vue()创。被创建出来的 vue 对象是一个逻辑上非完整实例对象，里面什么都没有，data 和 methods 都还没有初始化。")]),t._v(" "),a("p",[t._v("new 是一切的起点，new 之后才是『各个阶段』。")]),t._v(" "),a("h2",{attrs:{id:"_2-创建阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建阶段"}},[t._v("#")]),t._v(" 2. 创建阶段")]),t._v(" "),a("blockquote",[a("p",[t._v("创建阶段的『创建』很容易造成误会，误以为这是是创建 vue 对象，而实际上 vue 对象的创建时 new View() 干的时前。")])]),t._v(" "),a("p",[t._v("在创建阶段，Vue 干的事情有 2 件：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("为 "),a("code",[t._v("new Vue()")]),t._v(" 创建的 vue 实例的 data 和 methods 进行初始化。")])]),t._v(" "),a("li",[a("p",[t._v("根据 template 属性"),a("small",[t._v("（或 render 函数）")]),t._v("——在内存中——生成 DOM Element 对象。")])])]),t._v(" "),a("p",[t._v("所以，在创建阶段的『前半段』data 和 methods 是不可用的"),a("small",[t._v("（undefined）")]),t._v("，与此相关的 computed 和 watch 也是不可用的。而在『后半段』它们就都是可用的了。")]),t._v(" "),a("p",[t._v("需要强调的是，创建阶段『创建』的是 DOM 的 Element 对象，而它们仅仅是被创建出来，还未挂载到页面的 DOM 树上，因此，创建阶段对页面显示效果的影响仍然为零。")]),t._v(" "),a("p",[t._v("最后，逻辑上，在这个阶段，你可以进行逻辑操作，但不应该进行 DOM 操作。")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("beforeCreate")]),t._v(" 被调用时，意味着此时是创建阶段前半段；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("created")]),t._v(" 被调用时，意味着此时是创建阶段后半段。")])])]),t._v(" "),a("h2",{attrs:{id:"_3-挂载阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-挂载阶段"}},[t._v("#")]),t._v(" 3. 挂载阶段")]),t._v(" "),a("p",[t._v("挂在阶段的主要工作就是将创建阶段创建的 DOM Element 挂载到 HTML 页面的 DOM 树上，这样，这些 DOM Element 所代表的元素才能在页面上展现出来。")]),t._v(" "),a("p",[t._v("所以，在挂载阶段的『前半段』vue 实例的 "),a("code",[t._v("$el")]),t._v(" 是不可用的，于此同时，页面上也是没有内容展示的；而挂载阶段的『后半段』，"),a("code",[t._v("$el")]),t._v(" 就变成可用了，页面也会有你所期望的内容呈现出来。")]),t._v(" "),a("p",[t._v("另外，"),a("code",[t._v("$refs")]),t._v(" 和 "),a("code",[t._v("$el")]),t._v(" 一样，在 mounted 之后才可用。")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("beforeMount")]),t._v(" 被调用时，意味着此时是挂载阶段前半段；")]),t._v(" "),a("p",[t._v("所以此时我们通过 JS 的 innerText 获取页面元素的文本时内容为插值表达式本身（"+t._s()+"），而非具体的数据内容。")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("mounted")]),t._v(" 被调用时，意味着此时是挂载阶段后半段。")]),t._v(" "),a("p",[t._v("另外，即便是挂载阶段后半段，Vue 2.0 也不保证挂在了当前组件的所有子组件，即，有可能你的组件的显示效果有残缺"),a("small",[t._v("（有子组件未挂载、未渲染）")]),t._v("。如果需要整个视图渲染完毕，可以使用 "),a("code",[t._v("vm.$nextTick")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("mounted")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$nextTick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用 nextTick 来等待所有的视图都渲染完毕")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行代码")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),a("h2",{attrs:{id:"_4-更新阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-更新阶段"}},[t._v("#")]),t._v(" 4. 更新阶段")]),t._v(" "),a("p",[t._v("和创建、挂载阶段不同，『更新阶段』会反复出现。因为，更新阶段是 Vue 促使 data 数据和页面显示重新一致的阶段。")]),t._v(" "),a("p",[t._v("即，Vue 发现 data 中的数据有更新"),a("small",[t._v("（即，data 和页面数据不一致）")]),t._v("，它就会通过 DOM 操作区更新"),a("small",[t._v("（重新渲染）")]),t._v("页面，从而再次达到 data 数据和页面显示的一致。")]),t._v(" "),a("p",[t._v("显而易见，在这个阶段的『前半段』vue 实例的 data 和页面上的显示是不一致的；而在这个阶段的『后半段』它俩就再一次一致了。")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("beforeUpdate")]),t._v(" 被调用时，意味着此时是更新阶段前半段，这个时候，data 数据是最新的，但是页面数据是旧的；")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("updated")]),t._v(" 被调用时，意味着此时是更新阶段后半段，这个时候，页面数据已经更新成 data 那样了；")])])]),t._v(" "),a("h2",{attrs:{id:"_5-销毁阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-销毁阶段"}},[t._v("#")]),t._v(" 5. 销毁阶段")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("beforeDestroy")]),t._v("：vue 实例销毁之前调用。在这一步，vue 实例仍完全可用。")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("destroyed")]),t._v("：vue 实例销毁之后调用。调用后，vue 实例指示的所有东西都会解绑，所有的事件监听器会被移除，所有的子实例也会被销毁。")])])]),t._v(" "),a("h2",{attrs:{id:"_6-补充-keep-alive"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-补充-keep-alive"}},[t._v("#")]),t._v(" 6. 补充：keep-alive")]),t._v(" "),a("p",[t._v("keep-alive 标签包裹的组件在它们第一次被创建的时候就被缓存下来。与此相关的有两个生命周期钩子函数：activated 和 deactivated。当组件在内被切换时，activated 和 deactivated 这两个生命周期钩子函数将会被对应执行。")]),t._v(" "),a("p",[t._v("activated：在组件被激活时调用，在组价第一次渲染时也会被调用，之后每次 keep-alive 激活时被调用。")]),t._v(" "),a("p",[t._v("deactivated：在组件被停用时调用。")]),t._v(" "),a("p",[t._v("注意：只有组件被 keep-alive 包裹时，这两个生命周期才会被调用，如果作为正常组件使用，是不会被调用的。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://hemiao3000.gitee.io/java-note-img/images/vue/img/lifecycle.png",alt:"vue 钩子"}})])])}),[],!1,null,null,null);e.default=_.exports}}]);